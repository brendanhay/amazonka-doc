<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE OverloadedStrings     #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables   #-}</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-partial-type-signatures #-}</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-name-shadowing #-}</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-unused-imports #-}</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Example</span><span class="hs-operator">.</span><span class="hs-identifier">APIGateway</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-10"></a><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Lens</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span class="hs-operator">.</span><span class="hs-identifier">Class</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">AWS</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Monoid</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Network</span><span class="hs-operator">.</span><span class="hs-identifier">AWS</span><span class="hs-operator">.</span><span class="hs-identifier">APIGateway</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Network</span><span class="hs-operator">.</span><span class="hs-identifier">AWS</span><span class="hs-operator">.</span><span class="hs-identifier">Data</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-identifier">main</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Region</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">Method</span><span>
</span><a name="line-20"></a><a name="main"><a href="Example.APIGateway.html#main"><span class="hs-identifier">main</span></a></a><span> </span><a name="local-6989586621679056620"><a href="#local-6989586621679056620"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-21"></a><span>    </span><a name="local-6989586621679056730"><a href="#local-6989586621679056730"><span class="hs-identifier">lgr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newLogger</span><span> </span><span class="hs-identifier hs-var">Trace</span><span> </span><span class="hs-identifier hs-var">stdout</span><span>
</span><a name="line-22"></a><span>    </span><a name="local-6989586621679057151"><a href="#local-6989586621679057151"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">newEnv</span><span> </span><span class="hs-identifier hs-var">Discover</span><span> </span><span class="hs-operator hs-var">&lt;&amp;&gt;</span><span> </span><span class="hs-identifier hs-var">set</span><span> </span><span class="hs-identifier hs-var">envLogger</span><span> </span><a href="#local-6989586621679056730"><span class="hs-identifier hs-var">lgr</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">set</span><span> </span><span class="hs-identifier hs-var">envRegion</span><span> </span><a href="#local-6989586621679056620"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-23"></a><span>    </span><span class="hs-identifier hs-var">runResourceT</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">runAWST</span><span> </span><a href="#local-6989586621679057151"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-24"></a><span>        </span><a name="local-6989586621679057270"><a href="#local-6989586621679057270"><span class="hs-identifier">restApi</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">send</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">createRestAPI</span><span> </span><span class="hs-string">&quot;myApi&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679057271"><a href="#local-6989586621679057271"><span class="hs-identifier">apiId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057270"><span class="hs-identifier hs-var">restApi</span></a><span> </span><span class="hs-operator hs-var">^.</span><span> </span><span class="hs-identifier hs-var">raId</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span>        </span><a name="local-6989586621679057321"><a href="#local-6989586621679057321"><span class="hs-identifier">resources</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Resource</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">view</span><span> </span><span class="hs-identifier hs-var">grrsItems</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">send</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">getResources</span><span> </span><a href="#local-6989586621679057271"><span class="hs-identifier hs-var">apiId</span></a><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679057322"><a href="#local-6989586621679057322"><span class="hs-identifier">rootId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679057321"><span class="hs-identifier hs-var">resources</span></a><span> </span><span class="hs-operator hs-var">^.</span><span> </span><span class="hs-identifier hs-var">rId</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span>        </span><a name="local-6989586621679057498"><a href="#local-6989586621679057498"><span class="hs-identifier">resource</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Resource</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">send</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">createResource</span><span> </span><a href="#local-6989586621679057271"><span class="hs-identifier hs-var">apiId</span></a><span> </span><a href="#local-6989586621679057322"><span class="hs-identifier hs-var">rootId</span></a><span> </span><span class="hs-string">&quot;{file}&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679057499"><a href="#local-6989586621679057499"><span class="hs-identifier">fileResourceId</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057498"><span class="hs-identifier hs-var">resource</span></a><span> </span><span class="hs-operator hs-var">^.</span><span> </span><span class="hs-identifier hs-var">rId</span><span>
</span><a name="line-33"></a><span>        </span><a name="local-6989586621679057500"><a href="#local-6989586621679057500"><span class="hs-identifier">method</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Method</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">send</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">putMethod</span><span> </span><a href="#local-6989586621679057271"><span class="hs-identifier hs-var">apiId</span></a><span> </span><a href="#local-6989586621679057499"><span class="hs-identifier hs-var">fileResourceId</span></a><span> </span><span class="hs-string">&quot;GET&quot;</span><span> </span><span class="hs-string">&quot;NONE&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679057500"><span class="hs-identifier hs-var">method</span></a><span>
</span><a name="line-36"></a></pre></body></html>